+++
title = "crack et malware"
date = "2021-01-07"
description = "meta description soon"
tags = ["malware", "asm", "crack"]
categories = ["starting"]
author = "shellchocolat"
image = "images/crack-malware/genymotion/malware.png"
+++

J'ai téléchargé un crack pour un outil qui me posait quelques difficultés à cracker. Après tout, si le travail est déjà fait par quelqu'un ... Non en réalité, on va voir ici qu'il ne vaut mieux pas cracker de logiciel. Je vous assure qu'il ne vaut mieux pas ! Et si vous appréciez la version d'essai que vous êtes en train de tester, n'hésitez pas à payer l'outil plutôt que de tenter de le cracker. N'oubliez pas que cracker un logiciel est puni par la loi !!  

Les captures d'écrans ne seront pas floutés, car après tout quand un individu fait de la malveillance, autant le dénoncer aux yeux de tous :D Bon en fait, j'ai flouté quand même une partie du nom ... presomption d'innoncence et protection de la vie privée ...

Tout commence par une recherche __google__ concernant le crack de __genymotion__ dans le cas présent. On tombe sur un site qui propose un crack. C'est l'un des premiers de la liste: 

![image alt text](/images/crack-malware/genymotion/crack_page.png)

Bien sûr il y a également toute une liste de __pros and cons__ ainsi que les __requirements__ pour installer l'outil. Ca semble presque bien ... ou pas.

Après avoir cliqué sur le lien on passe par toute une séries de redirections (__bertet.xyx__, __installusd.com__, __makes4u.website__, ...). Puis on arrive enfin sur la page qui permet de télécharger le crack et qui ressemble à: 

![image alt text](/images/crack-malware/genymotion/crack_page_2.png)

La requête qui permet d'afficher cette page est:

![image alt text](/images/crack-malware/genymotion/crack_request.png)

Mmmhh, regardons ce qu'il se cache derrière cette ip (__18.207.144.81__). (on a le droit de hacker un hacker/cracker malveillant, hein ????). On va juste faire un simple __scan nmap__:

![image alt text](/images/crack-malware/genymotion/crack_scan_ip.png)

Oulalala, un joli petit dossier laissé là par pure gentillesse: __.git__

![image alt text](/images/crack-malware/genymotion/crack_ip_git.png)

On va s'amuser un peu. Regardons les logs git ... Une partie des logs est présentée ci-dessous:

![image alt text](/images/crack-malware/genymotion/crack_log_git.png)

<!---Oh le pauvre __Monsieur adnanghouri <adnanghouri97@gmail.com>__ qui dévoile au grand public son nom ... et qui s'appelle __Adnan Javed__: -->
Oh le pauvre __Monsieur adnangh\*\*\*\*97 <adnangh\*\*\*\**@gmail.com>__ qui dévoile au grand public son nom ... et qui s'appelle __Adnan J\*\*\*\*__:

![image alt text](/images/crack-malware/genymotion/crack_git_name.png)

Et qui vient du Pakistan:

![image alt text](/images/crack-malware/genymotion/crack_pak.png)

Bon, et si on téléchargait finalement ce  fichier qui est censé être notre crack tant attendu ...

Le fichier se nomme: __genymotion v3.1.2 crack license key download 2021 [updated]-4384b6a91a91ceac48faf66918b68876_07-01-21\_09 01 53.zip__.

C'est un zip qui contient un zip. Le fichier dézippé a le md5 suivant: __1e814cc7c8b292672fe81ed0c74b0430__ et VirusTotal le classe comme: 

![image alt text](/images/crack-malware/genymotion/crack_vt_1.png)


Regardons un peu ce que fait ce binaire avec Ida.

![image alt text](/images/crack-malware/genymotion/crack_ida_1.png)

On voit une requête GET vers __https://iplogger.org/1YQXf7__. __iplogger__ fournit un service de logging d'ip afin de savoir qui se connecte à votre site web. Utilisé ici, il permet de savoir qui a téléchargé et exécuté le logiciel malveillant (enfin, le crack je veux dire ...). Le paramètre __1YQXf7__ est un paramètre qui est associé à __Adnan J\*\*\*\*__.

Un peu plus loin dans le code, on voit également:

![image alt text](/images/crack-malware/genymotion/crack_ida_2.png)

Ce qui laisse penser que le "crack" va télécharger un autre outil sur __wedoo.best__ puis va le placer dans le dossier __Temp__ et l'exécuter avec un classique __cmd.exe__. On peut également voir qu'il est executé en mode __create no window__ afin que l'utilisateur ne voit pas ce qu'il se passe ...

Téléchargeons le fichier sur __wedoo.best__ et qui se nomme __Infosys.exe__. On remarquera au passage un petit __directory listing__ ...:

![image alt text](/images/crack-malware/genymotion/crack_directory_listing.png)

Bon, c'est quoi __infosys.exe__.

![image alt text](/images/crack-malware/genymotion/crack_infosys.png)

On dirait que c'est en réalité un outil qui provient de __Philandro Software__ et qui s'appelle __AnyDesk__.

![image alt text](/images/crack-malware/genymotion/crack_philandro.png)

Il semblerait que ce soit un outil de __Remote Desktop__ et qu'il permettrait de consulter le contenu d'un ordinateur distant ! Mais c'est pas le crack que j'ai demandé ! Et si en plus il s'en servait pour installer un __ransomware__. Ah le vilain __Adnan J\*\*\*\*__ !!!

Morale de l'histoire: n'installez pas de crack inconnu !!!! :D

(pour ceux qui veulent aller plus loin dans le hack ... feel free :D )

Ah, et une dernière chose. Pour ceux qui cherchent son email sur google (adnangh\*\*\*\*97@gmail.com), on y trouve une superbe page de son site "cv" (http://adnanJ\*\*\*\*.com/) sur lequel on peut télécharger son CV, voir ses tarifs, son adresse ...

![image alt text](/images/crack-malware/genymotion/crack_cv.png)

![image alt text](/images/crack-malware/genymotion/crack_location.png)

Puisque l'on a le dossier __.git__, il est possible de reconstruire l'ensemble du code source ainsi que tous les commits !!
Comme le code source n'est pas présent (on n'a que le __.git__), __git__ pense que l'on a tout supprimé. Il faut alors faire:
```
$ git stash
$ git stash drop
```

Et voilà on a restauré le code source backend et frontend !!!!

On peut ensuite naviguer dans les différents commit avec:
```
$ git log
$ git checkout <hash du commit>
```

Puis rechercher des noms d'utilisateurs, des passwords, des clefs d'api, des vulnérabilités, bref tout ce que l'on veut !

On a vu que Adnan J\*\*\*\* proposait ses services ... Qui veut l'embaucher ???? loool !!
